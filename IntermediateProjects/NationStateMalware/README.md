# Nation-State Malware Analysis: Regin

This project analyzes a real-world malware sample suspected to be used by nation-state actors. The malware binary used is named `Regin.exe`, a known example of advanced persistent threat (APT) malware. The goal is to extract static characteristics, detect known signatures, and prepare for further reverse engineering.

## Setup Instructions

1. Clone this repository or copy files into a folder:

2. Make sure you have the tools installed:
```
   - `yara`
   - `radare2`
   - `strings`
   - `file`
```

3. Create a Python virtual environment (optional but recommended):

   ```bash
   python3 -m venv venv
   source venv/bin/activat
   ```
Run the analysis script:
```
chmod +x setup.sh
./setup.sh
YARA Rule Example (rules/header_test.yar)
yara
rule MZ_Header {
    strings:
        $mz = "MZ"
    condition:
        $mz at 0
}
```
Analysis Results

File Type
Checked using file:

s
$(cat logs/static.log)
YARA Matches
Using the custom MZ_Header rule:

```
$(cat logs/yara_scan.log)
Extracted Strings
Saved in analysis/strings.txt â€” includes:
```
References to functions

Possible C2 domains

Suspicious patterns

Functions Identified
Extracted using radare2:

radare2 -A -q -c 'aaa;afl' samples/Regin.exe > analysis/r2_functions.txt
Findings
Key static findings are documented in findings.md. These include suspicious strings, confirmed PE structure, and presence of anti-analysis techniques.
#scs
![APT Malware Analysis](https://raw.githubusercontent.com/mchyasn/cyber-Projs-beginner-to-advanced/main/IntermediateProjects/NationStateMalware/screenshots/0.png)
![APT Malware Analysis](https://raw.githubusercontent.com/mchyasn/cyber-Projs-beginner-to-advanced/main/IntermediateProjects/NationStateMalware/screenshots/1.png)
![APT Malware Analysis](https://raw.githubusercontent.com/mchyasn/cyber-Projs-beginner-to-advanced/main/IntermediateProjects/NationStateMalware/screenshots/2.png)
![APT Malware Analysis](https://raw.githubusercontent.com/mchyasn/cyber-Projs-beginner-to-advanced/main/IntermediateProjects/NationStateMalware/screenshots/3.png)

Disclaimer
This project is for educational and research purposes only. Do not run or analyze malicious software on a host machine. Always use isolated virtual environments or sandbox environments.
